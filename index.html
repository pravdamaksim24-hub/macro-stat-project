<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macro Stats Project Prep</title>
    <style>
        :root {
            --primary: #2563eb;
            --secondary: #1e40af;
            --background: #f3f4f6;
            --surface: #ffffff;
            --text: #1f2937;
            --correct: #10b981;
            --wrong: #ef4444;
            --warning: #f59e0b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background);
            color: var(--text);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: var(--surface);
            width: 100%;
            max-width: 800px;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            margin: 20px;
        }

        /* --- MODE SELECTION SCREEN --- */
        #mode-screen { text-align: center; }
        .mode-btn-container {
            display: grid;
            gap: 1.5rem;
            margin-top: 2rem;
            grid-template-columns: 1fr 1fr;
        }
        .mode-btn {
            padding: 2rem;
            font-size: 1.2rem;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
        }
        .mode-btn:hover { transform: translateY(-3px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        .practice-mode { color: var(--primary); border-color: var(--primary); }
        .practice-mode:hover { background-color: #eff6ff; }
        .defense-mode { color: var(--warning); border-color: var(--warning); }
        .defense-mode:hover { background-color: #fffbeb; }

        /* --- QUIZ SCREEN --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        h1 { margin: 0; font-size: 1.5rem; color: var(--primary); }
        .stats { font-weight: bold; font-size: 1.1rem; }

        .question-box { margin-bottom: 2rem; }
        .question-text { font-size: 1.3rem; font-weight: 600; margin-bottom: 1.5rem; }
        .category-tag { 
            display: inline-block; 
            background: #e0e7ff; 
            color: var(--primary); 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-size: 0.8rem; 
            margin-bottom: 10px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .options-grid { display: grid; gap: 1rem; }

        .option-btn {
            padding: 1rem;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }

        .option-btn:hover:not(:disabled) {
            border-color: var(--primary);
            background-color: #eff6ff;
        }

        .option-btn.correct { background-color: var(--correct); color: white; border-color: var(--correct); }
        .option-btn.wrong { background-color: var(--wrong); color: white; border-color: var(--wrong); }

        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
        }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn:hover:not(:disabled) { background-color: var(--secondary); }
        .btn-secondary { background-color: #6b7280; }
        .btn-secondary:hover { background-color: #4b5563; }

        #explanation {
            margin-top: 15px;
            padding: 15px;
            background-color: #f0fdf4;
            border-left: 4px solid var(--correct);
            display: none;
        }

        /* End Screen */
        #end-screen { text-align: center; display: none; }
        .final-score { font-size: 3rem; font-weight: bold; color: var(--primary); margin: 2rem 0; }
        
        /* Utility */
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container" id="mode-screen">
    <h1>Macro Stats Project Prep</h1>
    <p>Select your preparation mode:</p>
    
    <div class="mode-btn-container">
        <button class="mode-btn practice-mode" onclick="startQuiz('practice')">
            üìö Practice Quiz
            <div style="font-size: 0.9rem; font-weight: normal; margin-top: 5px; color: #555;">
                Test your knowledge on course concepts, formulas, and general project facts.
            </div>
        </button>

        <button class="mode-btn defense-mode" onclick="startQuiz('defense')">
            üõ°Ô∏è Defense Simulation
            <div style="font-size: 0.9rem; font-weight: normal; margin-top: 5px; color: #555;">
                20 hard questions simulating a professor's critique. Focus on methodology, limitations, and deep interpretation.
            </div>
        </button>
    </div>
</div>

<div class="container hidden" id="quiz-container">
    <header>
        <h1 id="quiz-title">Quiz Mode</h1>
        <div class="stats">Score: <span id="score">0</span> / <span id="total">0</span></div>
    </header>

    <div class="question-box">
        <span class="category-tag" id="category">Topic</span>
        <div class="question-text" id="question">Loading Question...</div>
        <div class="options-grid" id="options">
            </div>
        <div id="explanation"></div>
    </div>

    <div class="controls">
        <button class="btn btn-secondary" onclick="location.reload()">Exit</button>
        <button class="btn" id="next-btn" onclick="nextQuestion()" disabled>Next Question</button>
    </div>
</div>

<div class="container hidden" id="end-screen">
    <h1 id="end-title">Quiz Completed!</h1>
    <div class="final-score" id="final-score">0%</div>
    <p id="end-message">Great job!</p>
    <button class="btn" onclick="location.reload()">Return to Menu</button>
</div>

<script>
    // ==========================================
    // DATASET 1: PRACTICE QUESTIONS (General)
    // ==========================================
    const practiceQuestions = [
        {
            category: "Project Basics",
            question: "What is the primary Research Question of your project?",
            options: [
                "How does unemployment affect inflation in the EU?",
                "How do GDP and Household Income vary across NUTS-1 regions, and are they spatially clustered?",
                "What is the impact of migration on Western European economies?",
                "How did the 2008 financial crisis impact Eastern Europe?"
            ],
            correct: 1,
            [cite_start]explanation: "Slide 11 explicitly states the research question focuses on GDP/Income variation and spatial clustering[cite: 11]."
        },
        {
            category: "Methodology",
            question: "What software did you use for the Spatial Analysis?",
            options: [
                "SPSS",
                "GeoDa",
                "E-Views",
                "Python only"
            ],
            correct: 1,
            [cite_start]explanation: "Slide 22 confirms GeoDa was used for spatial analysis[cite: 22]."
        },
        {
            category: "Project Data",
            question: "What is the source of your shapefiles?",
            options: [
                "Google Maps",
                "Eurostat - GISCO",
                "World Bank",
                "OpenStreetMap"
            ],
            correct: 1,
            [cite_start]explanation: "Slide 23: Eurostat ‚Äì Regional Database / GISCO[cite: 23]."
        },
        {
            category: "Spatial Theory",
            question: "What does Tobler's First Law of Geography state?",
            options: [
                "All regions are economically equal.",
                "Everything is related to everything else, but near things are more related than distant things.",
                "Distance does not matter in the digital age.",
                "Migration always flows from East to West."
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 4, Slide 9[cite: 1041]."
        },
        {
            category: "Spatial Theory",
            question: "What does a Moran's I value of -1 indicate?",
            options: [
                "Perfect positive clustering (High-High).",
                "Random distribution.",
                "Perfect dispersion (checkerboard pattern / negative autocorrelation).",
                "Zero correlation."
            ],
            correct: 2,
            [cite_start]explanation: "Lecture 4: -1 indicates perfect negative spatial autocorrelation[cite: 1262]."
        },
        {
            category: "National Accounts",
            question: "Which of the following is NOT a method for computing GDP?",
            options: [
                "The Output (Production) Approach",
                "The Income Approach",
                "The Expenditure Approach",
                "The Inflation Approach"
            ],
            correct: 3,
            [cite_start]explanation: "Lecture 5, Slide 9: The three methods are Output, Income, and Expenditure[cite: 578]."
        },
        {
            category: "Demographics",
            question: "What does the 'Crude Birth Rate' measure?",
            options: [
                "The total number of babies born.",
                "The number of live births per 1,000 people in a year.",
                "The average number of children a woman has.",
                "The percentage of the population that is pregnant."
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 3, Slide 7: (Live births / Population) * 1,000[cite: 148]."
        },
        {
            category: "Labor Stats",
            question: "Who is considered 'Unemployed' according to the ILO definition?",
            options: [
                "Anyone who doesn't have a job.",
                "A person without work, available to start within 2 weeks, and actively seeking work in the last 4 weeks.",
                "Students and retired people.",
                "Someone working part-time who wants full-time work."
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 3, Slide 39: The 3 conditions: Without work, Available, Actively seeking[cite: 336]."
        },
        {
            category: "Project Findings",
            question: "Based on your LISA Cluster Map, where are the 'High-High' clusters concentrated?",
            options: [
                "Eastern Europe (Romania, Bulgaria)",
                "Southern Europe (Spain, Portugal)",
                "The Economic Core: Germany, Belgium, Austria",
                "Northern UK and Ireland"
            ],
            correct: 2,
            [cite_start]explanation: "Slide 76: High-High clusters (core) are in Germany and Belgium[cite: 76]."
        },
        {
            category: "Indices",
            question: "Which index uses Base Period weights?",
            options: [
                "Paasche Index",
                "Laspeyres Index",
                "Fisher Index",
                "Bradford Index"
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 6, Slide 16: Laspeyres uses base period weights (q0)[cite: 462]."
        }
    ];

    // ==========================================
    // DATASET 2: DEFENSE QUESTIONS (Hard/Critical)
    // ==========================================
    const defenseQuestions = [
        {
            category: "Methodology Critique",
            question: "Your project uses Queen contiguity. If you had used 'Inverse Distance' weights instead, how might your results regarding the 'East-West gradient' change?",
            options: [
                "The results would be identical because weight matrices don't affect Moran's I.",
                "Distance weights might connect regions across water (e.g., Scandinavia to mainland) or unconnected borders, potentially revealing stronger core-periphery links than pure adjacency.",
                "Distance weights are illegal in NUTS-1 analysis.",
                "GeoDa cannot calculate distance weights."
            ],
            correct: 1,
            explanation: "Queen only looks at physical neighbors. [cite_start]Distance weights capture economic influence that 'jumps' borders (e.g., trade routes), which is a key limitation noted in slide 109[cite: 108]."
        },
        {
            category: "Data Limitations",
            question: "You identified a limitation regarding the NUTS-1 scale. Specifically, why is NUTS-1 potentially misleading for a country like Romania or France?",
            options: [
                "NUTS-1 data is often missing.",
                "NUTS-1 averages out extreme internal disparities (e.g., wealthy Bucharest vs. poor rural RO2), making the whole country look 'average'.",
                "NUTS-1 regions are too small to see global trends.",
                "NUTS-1 regions do not align with national borders."
            ],
            correct: 1,
            explanation: "Slide 107: 'NUTS-1 scale hides internal country differences'. [cite_start]Capital cities often have much higher GDP than the national average[cite: 107]."
        },
        {
            category: "Economic Interpretation",
            question: "You found that GDP is LESS spatially clustered than Household Income. What is the economic implication of this?",
            options: [
                "Productivity (GDP) is driven by specific industrial hubs/resources, while Income spreads out more evenly due to national welfare/social transfers.",
                "Income data is just less accurate than GDP data.",
                "It means the Moran's I for GDP was calculated incorrectly.",
                "It means rich regions are becoming poorer."
            ],
            correct: 0,
            explanation: "Slide 100: 'GDP is less spatially clustered than income'. [cite_start]Productivity shifts faster, but income (welfare) is smoothed by policy or remains sticky[cite: 100]."
        },
        {
            category: "Statistical Validity",
            question: "In your Global Moran's I analysis for 2014, the value was 0.330 (p=0.002). A professor argues this is a 'weak' correlation. How do you defend it?",
            options: [
                "Admit it is weak and the project failed.",
                "Argue that in spatial statistics, unlike Pearson correlation, a value of 0.33 is actually a moderate-to-strong indication of clustering, and the p-value confirms it is not random.",
                "Say that 0.33 is close to 1.",
                "Blame the data source."
            ],
            correct: 1,
            explanation: "Spatial autocorrelation values are often lower than standard correlations. [cite_start]0.33 with p=0.002 is statistically significant clustering[cite: 66, 68]."
        },
        {
            category: "Bivariate Analysis",
            question: "Your Bivariate Moran's I (GDP vs Income) is 0.44. Does this prove that high GDP *causes* high Income in neighboring regions?",
            options: [
                "Yes, correlation proves causation.",
                "No, it proves that high Income causes high GDP.",
                "No, it indicates spatial association (clustering), but not necessarily causality; variables like government policy or infrastructure could drive both.",
                "It indicates a negative relationship."
            ],
            correct: 2,
            explanation: "Moran's I measures association/clustering, not causality. [cite_start]Refer to Slide 82 regarding 'spillover effects' but be careful with the word 'cause'[cite: 82]."
        },
        {
            category: "Map Interpretation",
            question: "On your LISA Cluster map, you have 'High-Low' outliers (HL). What does a High-Low region represent in reality?",
            options: [
                "A poor region surrounded by rich neighbors.",
                "A rich economic hub (island of wealth) surrounded by poorer, less developed regions (e.g., a capital city in a developing country).",
                "A region with high inflation but low growth.",
                "A data error."
            ],
            correct: 1,
            explanation: "Lecture 4, Slide 29/Project Slide 78: High-Low means the region itself is High, but neighbors are Low. [cite_start]This often happens in transition zones[cite: 78]."
        },
        {
            category: "Data Choice",
            question: "Why did you choose PPS (Purchasing Power Standard) over Nominal Euros for your Income variable?",
            options: [
                "Nominal Euros look smaller on the map.",
                "PPS adjusts for price level differences, allowing us to compare the actual 'standard of living' between a cheap country (Romania) and an expensive one (Germany).",
                "PPS is the only data Eurostat provides.",
                "We flipped a coin."
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 6, Slide 18: PPS eliminates the effect of price level differences, making it the correct choice for welfare comparisons[cite: 635]."
        },
        {
            category: "Trend Analysis",
            question: "You claim a 'slight convergence' between 2014 and 2022 because Moran's I dropped. Is it possible for Moran's I to drop WITHOUT economic convergence?",
            options: [
                "No, they are perfectly linked.",
                "Yes, if the rich regions became random (dispersed) but stayed rich, Moran's I would drop, but the gap between rich and poor (inequality) might remain the same.",
                "Yes, but only if inflation is high.",
                "No, Moran's I measures the magnitude of GDP."
            ],
            correct: 1,
            explanation: "Critical thinking: Moran's I measures *clustering*. Convergence measures *inequality gap*. [cite_start]While related, less clustering doesn't automatically guarantee the poor caught up to the rich; it just means the rich aren't as clumped together[cite: 61]."
        },
        {
            category: "Methodology",
            question: "Why did you calculate 'Growth Rate' as (2022/2014) - 1? Why not just compare the raw numbers?",
            options: [
                "Raw numbers don't account for population size.",
                "Growth rate normalizes the starting point, allowing us to see which regions are catching up (dynamic view) vs just who is rich (static view).",
                "It was required by the professor.",
                "Excel couldn't handle the raw numbers."
            ],
            correct: 1,
            [cite_start]explanation: "Slide 47: Growth rate allows dynamic comparison of progress over time, essential for checking convergence[cite: 47]."
        },
        {
            category: "Policy Implications",
            question: "Your project concludes that 'disparities remain significant'. If you were an EU policy advisor, based on your Low-Low clusters, where would you invest Cohesion Funds?",
            options: [
                "Germany and Benelux (High-High clusters).",
                "Eastern and Southeastern Europe (the Low-Low periphery).",
                "Scandinavia.",
                "The UK."
            ],
            correct: 1,
            [cite_start]explanation: "Slide 77 identifies Eastern/Southeastern Europe as the Low-Low periphery, which is the target for Cohesion Policy mentioned in Slide 14[cite: 77]."
        },
        {
            category: "Anomalies",
            question: "What might explain the 'Not Significant' (grey) areas on your LISA map?",
            options: [
                "There is no data for those regions.",
                "Those regions have values that do not exhibit a statistically significant spatial pattern (random distribution) compared to their neighbors.",
                "Those regions have 0 GDP.",
                "The software crashed."
            ],
            correct: 1,
            [cite_start]explanation: "Lecture 4: 'Not Significant' means the spatial randomization test (999 permutations) did not find a pattern different from randomness[cite: 1374]."
        },
        {
            category: "Alternative Metrics",
            question: "You used GDP per Capita. Why is GVA (Gross Value Added) per worker sometimes a better measure for regional analysis?",
            options: [
                "It isn't.",
                "GVA per worker measures pure productivity without the distortion of taxes/subsidies and unrelated population (children/elderly).",
                "GVA is harder to calculate.",
                "GDP per capita excludes commuters."
            ],
            correct: 1,
            explanation: "Lecture 5, Slide 11/20: GVA is often used as a proxy for productivity. [cite_start]GDP per capita includes non-working population, which dilutes the productivity metric[cite: 603]."
        },
        {
            category: "Inflation Impact",
            question: "Your study covers 2014-2022. This period includes high inflation post-COVID. If your data was in 'Current Prices' (Nominal), how does this affect your growth conclusions?",
            options: [
                "It doesn't affect anything.",
                "Nominal growth might look huge solely due to inflation, masking the fact that real production might have stagnated.",
                "Inflation makes the growth look smaller.",
                "Nominal data is always better than Real data."
            ],
            correct: 1,
            explanation: "Lecture 6, Slide 17/19: Current prices are influenced by inflation. [cite_start]To see real economic convergence, you must account for price changes[cite: 623]."
        },
        {
            category: "Spatial Weights",
            question: "In GeoDa, what does the 'Order of Contiguity' (1st order vs 2nd order) change?",
            options: [
                "Nothing.",
                "1st order considers immediate neighbors. 2nd order considers 'neighbors of neighbors'. Using 2nd order might reveal wider regional trends.",
                "2nd order is only for NUTS-2.",
                "1st order is for GDP, 2nd order is for Income."
            ],
            correct: 1,
            explanation: "Lecture 4: Neighbors can be defined by hierarchy. Higher orders capture broader spillover effects."
        },
        {
            category: "Outliers",
            question: "Did you check for global outliers in your dataset (e.g., Luxembourg or Ireland) before running Moran's I? Why does this matter?",
            options: [
                "No, outliers don't matter.",
                "Yes, because an extreme outlier (like Luxembourg's inflated GDP) can skew the mean and artificially inflate/deflate the Moran's I coefficient.",
                "We deleted all outliers.",
                "Outliers make the map look prettier."
            ],
            correct: 1,
            explanation: "Standard statistical practice. [cite_start]Lecture 4 mentions Box Maps are used specifically to identify spatial outliers[cite: 1098]."
        },
        {
            category: "Correlation vs Autocorrelation",
            question: "What is the fundamental difference between Pearson's Correlation (r) and Moran's I?",
            options: [
                "Pearson measures relationship between two variables (X and Y). Moran's I measures relationship of a variable with ITSELF across space (X vs Lag-X).",
                "They are the same.",
                "Pearson is for maps, Moran is for charts.",
                "Moran's I can be greater than 1."
            ],
            correct: 0,
            [cite_start]explanation: "Lecture 4, Slide 12: Autocorrelation is correlation between values of the same variable (bi-directional among observations)[cite: 1058]."
        },
        {
            category: "Significance Testing",
            question: "Your LISA map shows clusters with p=0.05 and p=0.01. Which clusters are more reliable?",
            options: [
                "p=0.05 (Darker blue/red)",
                "p=0.01 (Lighter blue/red)",
                "The ones with p=0.01 are more statistically significant (less likely to be random noise) than p=0.05.",
                "Significance doesn't matter in geography."
            ],
            correct: 2,
            [cite_start]explanation: "Lecture 4, Slide 40: Lower p-values indicate higher statistical significance[cite: 1374]."
        },
        {
            category: "Cross-Border Issues",
            question: "Your map shows 'transition zones' near borders. Why are cross-border regions often HL or LH outliers?",
            options: [
                "Because borders stop economic interaction.",
                "Because of different national tax regimes, labor laws, or development levels colliding (e.g., West Germany vs East Germany/Poland border).",
                "GeoDa cannot handle borders.",
                "It is a glitch in the shapefile."
            ],
            correct: 1,
            [cite_start]explanation: "Project Slide 78: 'outliers near borders -> transition/disparity zones'[cite: 78]."
        },
        {
            category: "Dataset Selection",
            question: "You used 2014 and 2022. Why exclude the COVID years (2020-2021)?",
            options: [
                "We forgot them.",
                "2020-2021 data represents an external shock (pandemic) that creates temporary anomalies, potentially obscuring the long-term structural trends we wanted to analyze.",
                "There was no data for 2020.",
                "2022 is the only year that matters."
            ],
            correct: 1,
            explanation: "Defense Strategy: Excluding shock years is a valid methodological choice to analyze structural convergence rather than crisis management."
        },
        {
            category: "Conclusion Defense",
            question: "You conclude that 'Productivity shifts faster than household welfare'. How does your data support this?",
            options: [
                "It doesn't.",
                "Moran's I for GDP (0.33/0.22) is lower/changed more than Income (0.53/0.44). Income clusters are 'stickier' and change less, implying welfare is harder to shift than raw output.",
                "GDP is higher than Income.",
                "We just guessed."
            ],
            correct: 1,
            [cite_start]explanation: "Slide 100: 'GDP is less spatially clustered than income... productivity shifts faster than household welfare'[cite: 100]."
        }
    ];

    // --- QUIZ LOGIC ---
    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;

    const modeScreen = document.getElementById("mode-screen");
    const quizContainer = document.getElementById("quiz-container");
    const endScreen = document.getElementById("end-screen");

    const quizTitle = document.getElementById("quiz-title");
    const questionEl = document.getElementById("question");
    const categoryEl = document.getElementById("category");
    const optionsEl = document.getElementById("options");
    const nextBtn = document.getElementById("next-btn");
    const scoreEl = document.getElementById("score");
    const totalEl = document.getElementById("total");
    const explanationEl = document.getElementById("explanation");
    const finalScoreEl = document.getElementById("final-score");
    const endMessage = document.getElementById("end-message");

    function startQuiz(mode) {
        modeScreen.classList.add("hidden");
        quizContainer.classList.remove("hidden");

        if (mode === 'practice') {
            quizTitle.innerText = "Practice Quiz";
            quizTitle.style.color = "var(--primary)";
            // Shuffle and pick all practice questions
            currentQuestions = practiceQuestions.sort(() => Math.random() - 0.5);
        } else {
            quizTitle.innerText = "üõ°Ô∏è Defense Simulation";
            quizTitle.style.color = "var(--warning)";
            // Use defense questions
            currentQuestions = defenseQuestions.sort(() => Math.random() - 0.5);
        }

        currentQuestionIndex = 0;
        score = 0;
        totalEl.textContent = currentQuestions.length;
        scoreEl.textContent = "0";
        showQuestion();
    }

    function showQuestion() {
        resetState();
        const currentQuestion = currentQuestions[currentQuestionIndex];
        
        questionEl.textContent = `${currentQuestionIndex + 1}. ${currentQuestion.question}`;
        categoryEl.textContent = currentQuestion.category;

        currentQuestion.options.forEach((option, index) => {
            const button = document.createElement("button");
            button.innerText = option;
            button.classList.add("option-btn");
            button.addEventListener("click", () => selectAnswer(index, currentQuestion));
            optionsEl.appendChild(button);
        });
    }

    function resetState() {
        nextBtn.disabled = true;
        explanationEl.style.display = "none";
        explanationEl.innerText = "";
        while (optionsEl.firstChild) {
            optionsEl.removeChild(optionsEl.firstChild);
        }
    }

    function selectAnswer(selectedIndex, currentQuestion) {
        const correctIndex = currentQuestion.correct;
        const buttons = optionsEl.children;

        // Disable all buttons
        Array.from(buttons).forEach(btn => btn.disabled = true);

        // Highlight correct and wrong
        if (selectedIndex === correctIndex) {
            buttons[selectedIndex].classList.add("correct");
            score++;
            scoreEl.textContent = score;
        } else {
            buttons[selectedIndex].classList.add("wrong");
            buttons[correctIndex].classList.add("correct");
        }

        // Show explanation
        if (currentQuestion.explanation) {
            explanationEl.style.display = "block";
            explanationEl.innerHTML = `<strong>Explanation:</strong> ${currentQuestion.explanation}`;
        }

        nextBtn.disabled = false;
    }

    function nextQuestion() {
        currentQuestionIndex++;
        if (currentQuestionIndex < currentQuestions.length) {
            showQuestion();
        } else {
            showResults();
        }
    }

    function showResults() {
        quizContainer.classList.add("hidden");
        endScreen.classList.remove("hidden");
        const percentage = Math.round((score / currentQuestions.length) * 100);
        finalScoreEl.textContent = `${percentage}%`;

        if(percentage >= 80) {
            endMessage.innerText = "Excellent! You are ready for the presentation.";
            endMessage.style.color = "var(--correct)";
        } else if (percentage >= 50) {
            endMessage.innerText = "Good job, but review the explanations for the ones you missed.";
            endMessage.style.color = "var(--warning)";
        } else {
            endMessage.innerText = "Keep studying! Review the lectures and project methodology.";
            endMessage.style.color = "var(--wrong)";
        }
    }

</script>
</body>
</html>
